<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!--=============== REMIXICONS ===============-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.2.0/remixicon.min.css">

    <!--=============== CSS ===============-->
    <link rel="stylesheet" href="assets/css/styles.css">

    <title>Mega-celeb - Filtered Posts</title>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-GBPH7HNJBV"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-GBPH7HNJBV');
    </script>
</head>
<body>
    <script type='text/javascript' src='//constellationbedriddenexams.com/c7/aa/35/c7aa356d238d9636be852e7833d87197.js'></script>
    <script type="text/javascript">
        window._mfq = window._mfq || [];
        (function() {
            var mf = document.createElement("script");
            mf.type = "text/javascript"; mf.defer = true;
            mf.src = "//cdn.mouseflow.com/projects/aa607353-7e70-411e-83f6-fb9443e1de15.js";
            document.getElementsByTagName("head")[0].appendChild(mf);
        })();
    </script>
    
    <!--==================== HEADER ====================-->
    <header class="header" id="header">
        <nav class="nav container">
            <a href="index.html" class="nav__logo">Mega-celeb</a>
            <div class="nav__menu" id="nav-menu">
                <ul class="nav__list">
                    <li class="nav__item">
                        <a href="index.html" class="nav__link">
                            <span>Home</span>
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="celeb.html" class="nav__link">
                            <span>celebs</span>
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="onlyfans.html" class="nav__link">
                            <span>onlyfan</span>
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="#" class="nav__link">
                            <span>About us</span>
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="#" class="nav__link">
                            <span>Contact</span>
                        </a>
                    </li>
                </ul>
                <!-- Close button -->
                <div class="nav__close" id="nav-close">
                    <i class="ri-close-large-line"></i>
                </div>
            </div>
            <!-- Toggle button -->
            <div class="nav__toggle" id="nav-toggle">
                <i class="ri-menu-line"></i>
            </div>
        </nav>
    </header>

    <!--==================== MAIN ====================-->
    
    <div class="search">
        <input type="text" id="searchBar" placeholder="Search...">
    </div>
    <main class="container" id="postContainer">
        <!-- Filtered posts will be inserted here -->
    </main>

    <div class="pagination" id="pagination">
        <!-- Pagination will be inserted here -->
    </div>   
    
    <footer>
        <div class="footer23-social">
            <span class="social-item"><a href="http://plus.google.com/" target="_blank"><i class="fa fa-reddit round-icon"></i> Reddit</a></span>
            <span class="social-item"><a href="http://instagram.com/#" target="_blank"><i class="fa fa-instagram round-icon"></i> Instagram</a></span>
            <span class="social-item"><a href="http://.tumblr.com" target="_blank"><i class="fa-brands fa-discord"></i>Discord</a></span>
            <span class="social-item"><a href="https://t.me/celeb_posts" target="_blank"><i class="fa fa-telegram telegram-icon"></i>Telegram</a></span>
        </div>
        <div class="footer-link">
            <div class="footer11">
                <h2>our policy</h2>
                <p>term and condition</p>
                <p>privacy security</p>
                <p>Disclaimer</p>
            </div>
            <div class="footer22">
                <h2>about us</h2>
                <p>you can find a celebrities 
                <br>and onlyfans photo 
                <br>videos
                </p>
            </div>
        </div>
        <h1>copyright reserved 2024</h1>
    </footer>

    <!-- Custom JS for search and pagination -->
    <script>
        const postsPerPage = 16;
        let currentPage = 1;
        let allPosts = [];
        let filteredPosts = [];

        async function fetchPosts() {
            try {
                const response = await fetch('assets/js/post.json');
                if (!response.ok) {
                    throw new Error('Network response was not ok ' + response.statusText);
                }
                allPosts = await response.json();
                return allPosts;
            } catch (error) {
                console.error('Error fetching posts:', error);
                alert('Failed to load posts. Please try again later.');
                return [];
            }
        }

        function normalizeText(text) {
            return text.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "").replace(/[\W_]+/g, " ").trim();
        }

        function generateSearchVariants(text) {
            const variants = [text];
            const words = text.split(" ");

            if (words.length > 1) {
                variants.push(words.join(""));
                for (let i = 1; i < words.length; i++) {
                    variants.push(words.slice(0, i).join("") + " " + words.slice(i).join(" "));
                }
            }

            return variants;
        }

        async function handleSearch() {
            const searchTerm = normalizeText(document.getElementById('searchBar').value);
            const searchVariants = generateSearchVariants(searchTerm);
            const posts = await fetchPosts();

            // Filter posts to include only those with #onlyfan in the description
            filteredPosts = posts.filter(post => 
                normalizeText(post.description).includes("onlyfan")
            );

            currentPage = 1; // Reset to first page for new search
            displayPosts(filteredPosts);
            displayPagination(filteredPosts);
        }

        async function displayPosts(posts) {
            const postContainer = document.getElementById('postContainer');
            postContainer.innerHTML = '';
            const start = (currentPage - 1) * postsPerPage;
            const end = start + postsPerPage;
            const slicedPosts = posts.slice(start, end);

            if (slicedPosts.length === 0) {
                postContainer.innerHTML = '<p>No posts found.</p>';
            } else {
                slicedPosts.forEach((post, index) => {
                    const postElement = document.createElement('div');
                    postElement.classList.add('post');
                    postElement.innerHTML = `
                        <h2>${post.title}</h2>
                        ${post.image ? `<img src="${post.image}" alt="${post.title}" loading="lazy">` : ''}
                        ${post.video ? `<iframe src="${post.video}" frameborder="0" allowfullscreen></iframe>` : ''}
                        <p>${post.description}</p>
                    `;

                    postContainer.appendChild(postElement);
                });
            }
        }

        function updatePagination(totalPosts) {
            const paginationContainer = document.getElementById('pagination');
            paginationContainer.innerHTML = '';

            const totalPages = Math.ceil(totalPosts / postsPerPage);
            for (let i = 1; i <= totalPages; i++) {
                const pageButton = document.createElement('button');
                pageButton.textContent = i;
                if (i === currentPage) {
                    pageButton.classList.add('active');
                }
                pageButton.addEventListener('click', async () => {
                    currentPage = i; // Update current page
                    await displayPosts(filteredPosts); // Display posts for the current page
                    updatePagination(filteredPosts.length); // Update pagination
                });
                paginationContainer.appendChild(pageButton);
            }
        }

        document.getElementById('searchBar').addEventListener('input', handleSearch);

        // Initial display of posts and pagination
        async function initialize() {
            const posts = await fetchPosts();
            if (posts) {
                // Filter posts to include only those with #onlyfan in the description
                filteredPosts = posts.filter(post => 
                    normalizeText(post.description).includes("#onlyfan")
                );
                displayPosts(filteredPosts);
                updatePagination(filteredPosts.length);
            }
        }

        initialize();
    </script>
</body>
</html>
